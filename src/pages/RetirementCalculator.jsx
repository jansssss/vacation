import React, { useMemo, useState } from "react";
import CalculatorTemplate from "../components/CalculatorTemplate";
import { calculateSeverancePay } from "../lib/calculators/severancePay";
import { formatCurrency, formatNumber } from "../lib/formatters";
import { RULES_2026 } from "../config/rules/2026";

const RetirementCalculator = () => {
  const [avgMonthlyWage, setAvgMonthlyWage] = useState(3000000);
  const [years, setYears] = useState(3);
  const [months, setMonths] = useState(0);

  const result = useMemo(() => {
    return calculateSeverancePay({ avgMonthlyWage, years, months });
  }, [avgMonthlyWage, years, months]);

  const summaryLines = result && !result.error
    ? [
        `??됯맒 ??곸춦疫? ${formatCurrency(result.pay)}`,
        `域뱀눘?썸묾怨뚯퍢: ${years}??${months}揶쏆뮇??(??뤾텦 ${formatNumber(result.serviceYears)}??`,
        `???뇧?袁㏉닊 ?怨쀬젟 疫꿸퀗而? 筌ㅼ뮄??${result.averageWagePeriodMonths}揶쏆뮇??疫꿸퀣?`,
      ]
    : [
        "???뇧?袁㏉닊??域뱀눘?썸묾怨뚯퍢????낆젾??롢늺 ??됯맒 ??곸춦疫뀀뜆???④쑴沅??몃빍??",
        "?類?┛?怨몃연/?怨쀬삢??롫뼣 ??釉??????疫뀀맩肉???關肉???類ㅼ뵥??뤾쉭??",
        "甕곕벡???癒?뼊???袁⑹뒄??野껋럩???袁ⓓ?첎? ?怨룸뼖??亦낅슣???몃빍??",
      ];

  const steps = [
    `筌ㅼ뮄??${RULES_2026.severancePay.averageWagePeriodMonths}揶쏆뮇?????뇧?袁㏉닊 ??낆젾`,
    `域뱀눘?썸묾怨뚯퍢 ${years}??${months}揶쏆뮇???????μ맄嚥???뤾텦`,
    `???뇧?袁㏉닊 ??域뱀눘??怨쀫땾嚥???됯맒 ??곸춦疫??④쑴沅?,
  ];

  const exceptions = [
    "1??沃섎챶彛?域뱀눘??癒?벥 筌왖疫??遺쎄탷?? ?④쑴鍮??類κ묶???怨뺤뵬 ???わ쭪?????됰뮸??덈뼄.",
    "?怨몃연疫??怨쀬삢??롫뼣??筌ㅼ뮄??3揶쏆뮇?????釉??뤿??遺? ?類ㅼ뵥???袁⑹뒄??몃빍??",
    "??곸춦 筌욊낯??疫뀀맩肉?癰궰??덉뵠 ??됱몵筌????뇧?袁㏉닊 ?怨쀬젟???怨밸샨??餓λ씭???",
    "??곸춦/??곷씜 疫꿸퀗而?? ???뇧?袁㏉닊 ?怨쀬젟 ??뽰뇚 ??????怨뺤쨮 ?類ㅼ뵥??곷튊 ??몃빍??",
    "??곸춦?怨뚰닊 揶쎛????毓?關? 筌왖疫?獄쎻뫗?????? ????됰뮸??덈뼄.",
  ];

  const cases = [
    "??? 1) 筌ㅼ뮄??3揶쏆뮇?????뇧?袁㏉닊 3,200,000?? 域뱀눘??4?? ??됯맒 ??곸춦疫?12,800,000?? ?怨몃연/?怨쀬삢??롫뼣 ??釉??????疫뀀맩肉???關肉???類ㅼ뵥.",
    "??? 2) 域뱀눘??11揶쏆뮇????곴텢: ?癒?뒅?怨몄몵嚥???곸춦疫????怨몃퓠????뽰뇚??????됱몵???④쑴鍮??類κ묶/?癒? ?類ㅼ뵥 ?袁⑹뒄.",
    "??? 3) ??곸춦 筌욊낯??2揶쏆뮇??疫뀀맩肉у첎? 10% ?紐꾧맒??野껋럩?? ???뇧?袁㏉닊 ?④쑴沅?疫꿸퀣??????????됯맒??れ뵠 筌앹빓???????됱벉.",
  ];

  const faqs = [
    {
      question: "??곸춦疫뀀뜆? ?紐꾩젫 筌왖疫뀀맪鍮????롪돌??",
      answer: "???맒 ??곸춦??곗쨮?봔??14????沅?筌왖疫뀀맩???癒?뒅??援????텢 ??????怨뺤뵬 ?臾믪벥??????됰뮸??덈뼄.",
    },
    {
      question: "???뇧?袁㏉닊 ?怨쀬젟???怨몃연疫뀀뜆????釉??롪돌??",
      answer: "筌ㅼ뮄??3揶쏆뮇?????類?┛?怨몃연揶쎛 ??덈뼄筌???釉??????됰선 疫뀀맩肉???關???類ㅼ뵥??곷튊 ??몃빍??",
    },
    {
      question: "?怨쀬삢??롫뼣?????뇧?袁㏉닊????釉??롪돌??",
      answer: "?類?┛?怨몄몵嚥?筌왖疫뀀맧由???怨쀬삢??롫뼣?? ???뇧?袁㏉닊??獄쏆꼷???????됰뮸??덈뼄.",
    },
    {
      question: "1??沃섎챶彛?域뱀눘??癒?뮉 ??곸춦疫뀀뜆??獄쏆룇??????욧돌??",
      answer: "??곗뺘?怨몄몵嚥?1????곴맒 域뱀눘???疫꿸퀣????筌???됱뇚揶쎛 ??됱뱽 ????됰선 ?類ㅼ뵥???袁⑹뒄??몃빍??",
    },
    {
      question: "??곸춦 筌욊낯??疫뀀맩肉у첎? ??苡?癰궰??뉖┷筌???堉멨칰???롪돌??",
      answer: "???뇧?袁㏉닊 ?怨쀬젟 疫꿸퀗而???癰궰??덉뵠 獄쏆꼷????嚥??④쑴沅?野껉퀗?드첎? ???わ쭪?????됰뮸??덈뼄.",
    },
    {
      question: "???뇧?袁㏉닊 ?怨쀬젟 疫꿸퀗而?? ??堉멨칰??④쑴沅??롪돌??",
      answer: "???맒 ??곸춦????곸읈 3揶쏆뮇????袁㏉닊??疫꿸퀣???곗쨮 ??몃빍??",
    },
    {
      question: "??곸춦?怨뚰닊(DB/DC) 揶쎛?????④쑴沅????삘뀲揶쎛??",
      answer: "筌왖疫?獄쎻뫗?뉑??④쑴沅?疫꿸퀣?????? ????됰선 ??뺣즲癰???덇땀???類ㅼ뵥??곷튊 ??몃빍??",
    },
    {
      question: "?얜떯???곸춦 疫꿸퀗而?????뇧?袁㏉닊????釉??롪돌??",
      answer: "??곸춦 疫꿸퀗而???뽰뇚 ?????域뱀뮇?숁???곴퐤???怨뺤뵬 ??? ????됰뮸??덈뼄.",
    },
    {
      question: "??곸춦疫??④쑴沅?野껉퀗??? ??쇱젫 筌왖疫뀀맩釉?筌△뫁?졾첎? ??됱뱽 ????덇돌??",
      answer: "?袁㏉닊 ??????釉?????? 域뱀눘???怨쀬젟 疫꿸퀣????怨뺤뵬 筌△뫁?졾첎? 獄쏆뮇源??????됰뮸??덈뼄.",
    },
    {
      question: "?④쑴沅?野껉퀗?든몴??얜챷苑뚧에???뽱뀱??猷???롪돌??",
      answer: "??? 筌〓㈇???뱀몵嚥???뽰뒠??랁? ?⑤벊???怨쀬젟?? ?紐꾧텢?? 野꺜?醫? ?袁⑹뒄??몃빍??",
    },
  ];

  const sources = [
    "域뱀눖以덃묾怨?甕곕벡湲???곸춦疫뀀맩肉??怨쀬젟 疫꿸퀣?(?遺용튋 ?怨몄뒠)",
    `疫꿸퀣??? ${RULES_2026.effectiveDate} / ??낅쑓??꾨뱜: ${RULES_2026.updatedAt}`,
    "???뇧?袁㏉닊 ??釉?????? 疫뀀맩肉???觀????沅?域뱀뮇???곗쨮 ?類ㅼ뵥 ?袁⑹뒄",
  ];

  const relatedLinks = [
    { title: "?怨쀪컧 ?④쑴沅쎿묾?, path: "/calculators/annual-leave" },
    { title: "??곸춦疫?筌왖疫??????癒?뼊 疫꿸퀣?", path: "/guides/severance-pay-eligibility" },
    { title: "???뇧?袁㏉닊 ?怨쀬젟 ????釉???뽰뇚 ????, path: "/guides/severance-pay-average-wage" },
    { title: "??곸춦疫??類ㅺ텦 ??뺤첒 筌ｋ똾寃뺟뵳????, path: "/guides/severance-pay-docs" },
    { title: "?怨쀪컧 疫꿸퀡??域뱀뮇???????遺용튋", path: "/guides/annual-leave-basics" },
    { title: "?얜떯???곸춦???怨쀪컧/??곸춦疫뀀뜆肉?沃섎챷????怨밸샨", path: "/guides/unpaid-leave-impact" },
    { title: "疫뀀맩肉э쭗?녾쉭????덈뮉 甕?, path: "/guides/payroll-slip-reading" },
    { title: "?怨쀪컧??롫뼣 ?類ㅺ텦 ???酉釉???살첒", path: "/guides/annual-leave-encashment" },
    { title: "?④쑴沅쎿묾???덊닏嚥???猷?, path: "/calculators" },
  ];

  const trust = {
    checklist: [
      "筌ㅼ뮄??3揶쏆뮇??疫뀀맩肉????獄?域뱀눛源?疫꿸퀡以??類ｋ궖",
      "?類?┛?怨몃연/?怨쀬삢??롫뼣 ??釉???? ?類ㅼ뵥",
      "域뱀눘?썸묾怨뚯퍢 ?怨쀬젟 疫꿸퀣????얜챷苑??,
      "??곸춦?怨뚰닊(DB/DC) ????? 筌왖疫?獄쎻뫗???類ㅼ뵥",
      "??곸춦疫?筌왖疫???깆젟 獄?筌왖疫???곷열 野꺜??,
      "筌욊낯????살구 ?癒?┷(FAQ) ????餓Β??,
    ],
    disputePoints: [
      "???뇧?袁㏉닊 ??釉????????????곴퐤 筌△뫁??,
      "1??沃섎챶彛?域뱀눘??癒?벥 筌왖疫????",
      "??곸춦 筌욊낯??疫뀀맩肉?癰궰??덈퓠 ?怨뺚뀲 ???뇧?袁㏉닊 ?怨쀬젟",
    ],
    notices: [
      "??곸춦疫??怨쀬젟?? 筌ㅼ뮄??3揶쏆뮇?????뇧?袁㏉닊??疫꿸퀣???곗쨮 ??렽? ??釉?????? 疫뀀맩肉???關肉???類ㅼ뵥??몃빍??",
      "??곸춦疫?筌왖疫???깆젟?? ??곸춦??疫꿸퀣? 14????沅?筌왖疫??癒?뒅??援??臾믪벥嚥?鈺곌퀣???????됰뮸??덈뼄.",
      "??곸춦?怨뚰닊(DB/DC) 揶쎛??놁쁽????뺣즲癰??怨쀬젟 疫꿸퀣?????삘뀮??癰귢쑬猷???덇땀??筌〓㈇???雅뚯눘苑??",
    ],
  };

  const breadcrumbs = [
    { label: "??, path: "/" },
    { label: "?④쑴沅쎿묾?, path: "/calculators" },
    { label: "??곸춦疫??④쑴沅쎿묾?, path: "/calculators/severance-pay" },
  ];

  return (
    <CalculatorTemplate
      seo={{
        title: "??곸춦疫??④쑴沅쎿묾?,
        description: "???뇧?袁㏉닊??域뱀눘?썸묾怨뚯퍢????낆젾??롢늺 ??됯맒 ??곸춦疫뀀뜆????ｍ롨퉪袁⑥쨮 ?④쑴沅??몃빍??",
        path: "/calculators/severance-pay",
      }}
      breadcrumbs={breadcrumbs}
      title="??곸춦疫??④쑴沅쎿묾?
      description="???뇧?袁㏉닊??域뱀눘?썸묾怨뚯퍢????낆젾??롢늺 ??됯맒 ??곸춦疫뀀뜆???④쑴沅??랁? ??뿅???됱뇚?? FAQ繹먮슣? ??볥궗??몃빍??"
      updatedAt={RULES_2026.updatedAt}
      summaryLines={summaryLines}
      steps={steps}
      exceptions={exceptions}
      cases={cases}
      faqs={faqs}
      sources={sources}
      relatedLinks={relatedLinks}
      trust={trust}
    >
      <div className="space-y-6">
        <div className="grid gap-4 md:grid-cols-3">
          <label className="text-sm text-slate-600 md:col-span-2">
            筌ㅼ뮄??3揶쏆뮇?????뇧?袁㏉닊 (??
            <input
              type="number"
              value={avgMonthlyWage}
              onChange={(event) => setAvgMonthlyWage(Number(event.target.value))}
              className="mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-right"
              min={0}
            />
          </label>
          <label className="text-sm text-slate-600">
            域뱀눘???怨쀫땾 (??
            <input
              type="number"
              value={years}
              onChange={(event) => setYears(Number(event.target.value))}
              className="mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-right"
              min={0}
            />
          </label>
          <label className="text-sm text-slate-600">
            ?곕떽? 域뱀눘??(揶쏆뮇??
            <input
              type="number"
              value={months}
              onChange={(event) => setMonths(Number(event.target.value))}
              className="mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-right"
              min={0}
              max={11}
            />
          </label>
        </div>

        {result && result.error && (
          <div className="rounded-xl border border-rose-100 bg-rose-50 p-4 text-sm text-rose-600">
            {result.error}
          </div>
        )}

        {!result.error && (
          <div className="rounded-xl border border-emerald-100 bg-emerald-50 p-4">
            <div className="flex items-baseline justify-between">
              <p className="text-sm text-emerald-700">??됯맒 ??곸춦疫?/p>
              <p className="text-2xl font-semibold text-emerald-800">
                {formatCurrency(result.pay)}
              </p>
            </div>
            <div className="mt-4 space-y-2 text-sm text-slate-600">
              <div className="flex justify-between">
                <span>域뱀눘?썸묾怨뚯퍢 ??뤾텦</span>
                <span>{formatNumber(result.serviceYears)}??/span>
              </div>
              <div className="flex justify-between">
                <span>???뇧?袁㏉닊 疫꿸퀣?</span>
                <span>筌ㅼ뮄??{result.averageWagePeriodMonths}揶쏆뮇??/span>
              </div>
            </div>
          </div>
        )}
      </div>
    </CalculatorTemplate>
  );
};

export default RetirementCalculator;
